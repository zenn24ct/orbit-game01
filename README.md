📘 Orbit Collector — Rewritten
A minimal, stylish orbit–capture action game built with Canvas + JavaScript


🎮 ゲーム概要

Orbit Collector — Rewritten は、中心から発射する「パルス波紋」を使って、周回する粒子（パーティクル）を引き寄せ、指定された“色のターゲット”だけを捕獲してスコアを競うゲームです。

マウス操作 or Space キーでチャージ → 発射

チャージ量に応じて波紋の強さ・範囲・スタン効果が変化

ターゲット色だけを正しく集めるとコンボ

60 秒でどこまでスコアを伸ばせるか挑戦！

Canvas 上でスムーズに動作する軽量ゲームで、スマホ・PC どちらにも対応しています。

🕹 操作方法
マウス / タッチ
動作	説明
押し続ける	チャージ開始。中心位置もカーソル側に滑らかに寄る
離す	パルスを発射
押しながら移動	中心位置をスムーズに移動
キーボード
キー	説明
Space	押し続けてチャージ → 離すと発射
🎯 ルール

周囲を周回するパーティクルは 色ごとに分類されている

画面左の「Target」に示された色帯のパーティクルだけが得点対象

捕獲（＝中心付近に来たとき）すると以下の処理が起きる：

✔ 成功（色が一致）

+14 点 + コンボボーナス

コンボ数 +1

コンボが続くほど加点が増える

派手なエフェクトと加点テキストが出る

❌ 失敗（違う色）

-6 点ペナルティ（最低 0）

コンボリセット

攻撃色のエフェクトが出る

⚙ 設定項目（パネル）
設定	説明
Particles	パーティクル数（少→軽い、多→難易度UP）
Trail length	残像の長さ
Capture radius	捕獲される中心範囲の大きさ

設定変更はリアルタイムに反映されます。

✨ 特徴（Features）

✔ リファクタ済みの読みやすいコード

✔ Canvas ベースの高速描画

✔ 色判定の精密化（距離/パルス判定/スタン効果を統合）

✔ チャージ量に応じてパルス特性が変化

✔ スコアとコンボが視覚化されたエフェクト

✔ PC / スマホ対応（タッチ追従処理）

✔ 中心位置が常に canvas 内に収まるセーフティ処理付き

🧩 実装ポイント（Developer Notes）
● パルス挙動

半径の増加：range * progress

可視時間：PULSE_VIS

壁衝突なし、すべて中心からの波紋

● パーティクル挙動

個別に軌道（orbit）、角速度（angVel）、色（hue）を持つ

pulled（スタン）中は回転速度を低減

orbit はパルスで縮む → 中心へ吸い込まれやすくなる

● 捕獲処理

成功条件：

距離が params.capture 内

pulled が一定量以上、または極端に中心近く

色差（ΔHue）が 22° 以下

二重捕獲防止：

p.captured = true;

● タイマー

game.timeLeft は毎フレーム減算し、timeEl で UI 更新。

📦 セットアップ

ブラウザだけで動作します。インストール不要。

index.html を開くだけ


ローカルサーバーで動かす場合：
npx serve

# または
python3 -m http.server

🛠 開発（任意）

fitCanvas()：画面リサイズ時の DPI & セーフティ処理

spawnParticles()：各種ランダム生成

loop()：メインフレーム処理

tryCapture()：捕獲・色判定ロジック

captureIndex()：スコア/コンボ制御＋エフェクト生成
